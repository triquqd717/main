hookfunction(game:GetService("ContentProvider").PreloadAsync, function(...)
	return task.defer(function() end)
end)

local Speed_Library = loadstring(
	game:HttpGet("https://raw.githubusercontent.com/triquqd717/main/refs/heads/main/Modified-Optimized-V5.lua")
)()
local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local TweenService = game:GetService("TweenService")
local Highlight = Instance.new("Highlight")
Highlight.FillTransparency = 0.5
Highlight.OutlineColor = Color3.fromRGB(0, 255, 0)
Highlight.Parent = game:GetService("CoreGui")
Highlight.Enabled = false

local currentHighlight = nil
local lastTargetCharacter = nil
local ctrlHeld = false
local spaceHeld = false

local Player = Players.LocalPlayer
local character = Player.Character or Player.CharacterAdded:Wait()
local humanoid = character:FindFirstChildOfClass("Humanoid") or character:WaitForChild("Humanoid")

local window = Speed_Library:CreateWindow({
	Title = "Speed Hub Z | Version: 1.0.0 | discord.gg/speedhubx",
	Description = "",
	TabWidth = 120,
	SizeUi = UDim2.fromOffset(550, 315),
})

local config = {
	WalkspeedChanger = {
		Enabled = false,
		Speed = 16,
	},
	InfiniteJump = {
		Enabled = false,
	},
	NoClip = {
		Enabled = false,
	},
	Teleport = {
		Enabled = false,
		Connection = nil,
	},
	serverinfo = {
		JobId = "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",
		PlaceId = nil,
	},
}

local function handleTeleport()
	if config.Teleport.Connection then
		config.Teleport.Connection:Disconnect()
		config.Teleport.Connection = nil
	end

	if config.Teleport.Enabled then
		local mouse = Player:GetMouse()
		local connections = {}
		local baseDetectionRadius = 5
		local maxDetectionRadius = 30
		local maxDistanceForScaling = 1000

		local function isCtrlDown()
			return UserInputService:IsKeyDown(Enum.KeyCode.LeftControl)
				or UserInputService:IsKeyDown(Enum.KeyCode.RightControl)
		end

		local ctrlCheckConnection = RunService.Heartbeat:Connect(function()
			if not isCtrlDown() and ctrlHeld then
				ctrlHeld = false
				if connections.mouseMove then
					connections.mouseMove:Disconnect()
					connections.mouseMove = nil
				end
				if currentHighlight then
					currentHighlight.Adornee = nil
					currentHighlight.Enabled = false
				end
			end
		end)

		connections.ctrlDown = UserInputService.InputBegan:Connect(function(input, gameProcessed)
			if gameProcessed then
				return
			end
			if input.KeyCode == Enum.KeyCode.LeftControl or input.KeyCode == Enum.KeyCode.RightControl then
				ctrlHeld = true

				connections.mouseMove = mouse.Move:Connect(function()
					if not isCtrlDown() then
						return
					end

					local camera = workspace.CurrentCamera
					local mousePos = UserInputService:GetMouseLocation()
					local ray = camera:ViewportPointToRay(mousePos.X, mousePos.Y)
					local raycastParams = RaycastParams.new()
					raycastParams.FilterType = Enum.RaycastFilterType.Blacklist
					raycastParams.FilterDescendantsInstances = { Player.Character }
					local raycastResult = workspace:Raycast(ray.Origin, ray.Direction * 1000, raycastParams)

					local nearestPlayer = nil
					local closestDistance = math.huge

					if raycastResult then
						local localRoot = Player.Character and Player.Character:FindFirstChild("HumanoidRootPart")
						if localRoot then
							for _, player in ipairs(Players:GetPlayers()) do
								if player ~= Player and player.Character then
									local targetRoot = player.Character:FindFirstChild("HumanoidRootPart")
									if targetRoot then
										local distanceFromLocal = (localRoot.Position - targetRoot.Position).Magnitude
										local detectionRadius = math.min(
											baseDetectionRadius
												+ (distanceFromLocal / maxDistanceForScaling)
													* (maxDetectionRadius - baseDetectionRadius),
											maxDetectionRadius
										)
										local distanceToMouse = (targetRoot.Position - raycastResult.Position).Magnitude
										if distanceToMouse < detectionRadius and distanceToMouse < closestDistance then
											closestDistance = distanceToMouse
											nearestPlayer = player.Character
										end
									end
								end
							end
						end
					end

					if nearestPlayer then
						if not currentHighlight then
							currentHighlight = Highlight:Clone()
							currentHighlight.Parent = game:GetService("CoreGui")
						end
						currentHighlight.Adornee = nearestPlayer
						currentHighlight.Enabled = true
						lastTargetCharacter = nearestPlayer
					else
						if currentHighlight then
							currentHighlight.Adornee = nil
							currentHighlight.Enabled = false
						end
						lastTargetCharacter = nil
					end
				end)
			end
		end)

		connections.mouseClick = mouse.Button1Down:Connect(function()
			if isCtrlDown() then
				pcall(function()
					local root = Player.Character and Player.Character:FindFirstChild("HumanoidRootPart")
					if root then
						local targetCFrame

						if lastTargetCharacter and lastTargetCharacter:FindFirstChild("HumanoidRootPart") then
							targetCFrame = lastTargetCharacter.HumanoidRootPart.CFrame
						else
							local rotation = root.CFrame - root.Position
							targetCFrame = CFrame.new(mouse.Hit.Position + Vector3.new(0, 2, 0)) * rotation
						end

						local tween = TweenService:Create(
							root,
							TweenInfo.new(0.1, Enum.EasingStyle.Linear),
							{ CFrame = targetCFrame }
						)
						tween:Play()
					end
				end)
			end
		end)

		config.Teleport.Connection = {
			Disconnect = function()
				ctrlCheckConnection:Disconnect()
				for _, connection in pairs(connections) do
					if connection then
						connection:Disconnect()
					end
				end
				if currentHighlight then
					currentHighlight:Destroy()
					currentHighlight = nil
				end
				lastTargetCharacter = nil
				ctrlHeld = false
			end,
		}
	end
end

local JumpConnection
local noclipConnection

Player.CharacterAdded:Connect(function(newCharacter)
	character = newCharacter
	humanoid = newCharacter:WaitForChild("Humanoid")

	if config.WalkspeedChanger.Enabled then
		humanoid.WalkSpeed = config.WalkspeedChanger.Speed
	end
end)

local function enableNoClip()
	if noclipConnection then
		return
	end
	noclipConnection = RunService.Stepped:Connect(function()
		if character and config.NoClip.Enabled then
			for _, part in pairs(character:GetDescendants()) do
				if part:IsA("BasePart") then
					part.CanCollide = false
				end
			end
		end
	end)
end

local function disableNoClip()
	if noclipConnection then
		noclipConnection:Disconnect()
		noclipConnection = nil
	end
end

local function enableInfiniteJump()
	if JumpConnection then
		return
	end

	local function jumpAction()
		if humanoid and config.InfiniteJump.Enabled and spaceHeld then
			humanoid:ChangeState(Enum.HumanoidStateType.Jumping)
		end
	end

	JumpConnection = RunService.Heartbeat:Connect(jumpAction)

	UserInputService.InputBegan:Connect(function(input, gameProcessed)
		if gameProcessed or input.KeyCode ~= Enum.KeyCode.Space then
			return
		end
		spaceHeld = true
	end)

	UserInputService.InputEnded:Connect(function(input)
		if input.KeyCode == Enum.KeyCode.Space then
			spaceHeld = false
		end
	end)
end

local function disableInfiniteJump()
	if JumpConnection then
		JumpConnection:Disconnect()
		JumpConnection = nil
	end
	spaceHeld = false
end

local tabHome = window:CreateTab({ Name = "Home" })
local Discord = tabHome:AddSection("Discord", true)
local section1 = tabHome:AddSection("LocalPlayer", true)

Discord:AddButton({
	Title = "Discord Invite",
	Content = "Click to Copy Invite Link",
	Callback = function()
		setclipboard("https://discord.gg/speedhubx")
		Speed_Library:SetNotification({
			Title = "Copied to clipboard!",
			Delay = 1,
		})
	end,
})

local initialized = false
section1:AddInput({
	Title = "Set Speed",
	Content = "",
	Callback = function(text)
		if not initialized then
			initialized = true
			return
		end

		local newSpeed
		if text:lower():match("math%.huge") then
			newSpeed = math.huge
			Speed_Library:SetNotification({
				Title = "OMG HAXXOR?!",
				Content = "Infinite speed activated! ðŸš€",
				Time = 0.3,
				Delay = 2,
			})
		else
			newSpeed = tonumber(text)
		end

		if newSpeed and newSpeed > 0 then
			config.WalkspeedChanger.Speed = newSpeed
			if config.WalkspeedChanger.Enabled and humanoid then
				humanoid.WalkSpeed = newSpeed
			end
		else
			Speed_Library:SetNotification({
				Title = "Invalid Speed",
				Content = "Please input a positive number!",
				Time = 0.3,
				Delay = 2,
			})
		end
	end,
})

local games = {
	["adopt me"] = 920587237,
	["anime cross 2"] = 3182549358,
	["anime fighting simulator"] = 5009471751,
	["arsenal"] = 286090429,
	["babft"] = 537413528,
	["bee swarm"] = 1537690962,
	["big paintball"] = 3653137302,
	["blox fruits"] = 2753915549,
	["bloxburg"] = 185655149,
	["break in"] = 5072710163,
	["brookhaven"] = 4924922222,
	["build a boat"] = 537413528,
	["build a boat for treasure"] = 537413528,
	["dress to impress"] = 15101393044,
	["epic minigames"] = 352226052,
	["fisch"] = 16732694052,
	["flee the facility"] = 609149114,
	["fling simulator"] = 6554791685,
	["island royale"] = 2632079674,
	["jailbreak"] = 606849621,
	["jujutsu infinite"] = 10450270085,
	["loomian legacy"] = 4814460316,
	["lumber tycoon 2"] = 204118410,
	["mad city"] = 6447791247,
	["muscle legends"] = 3623096087,
	["murder mystery 2"] = 142823291,
	["murder mystery x"] = 5063439328,
	["my restaurant!"] = 4103494616,
	["naval warfare"] = 2210085102,
	["ninja legends 2"] = 5244617481,
	["pet simulator x"] = 6284583030,
	["piggy"] = 4623386862,
	["prison life"] = 155615604,
	["racing legends"] = 420083209,
	["rogue lineage"] = 4100538041,
	["sharkbite"] = 1001893246,
	["shindo life"] = 4616652839,
	["skyblock"] = 6711846670,
	["speed run 4"] = 550108881,
	["speed simulator"] = 7064669238,
	["super bomb survival"] = 314123057,
	["super power fighting simulator"] = 1725822310,
	["survivor"] = 438329464,
	["tapping legends x"] = 5949022791,
	["the mimic"] = 3233090307,
	["the quarry"] = 1291565394,
	["theme park tycoon 2"] = 402981713,
	["tiny town tycoon"] = 150357239,
	["tornado alley ultimate"] = 2532964936,
	["tower battles"] = 1582681289,
	["tower defense simulator"] = 3260590327,
	["tower of hell"] = 1962086868,
	["ultimate driving"] = 766290072,
	["vehicle simulator"] = 410996670,
	["vibe district"] = 231312703,
	["wormhole"] = 2310918754,
	["work at a pizza place"] = 192008999,
	["world // zero"] = 2541519314,
	["zombie attack"] = 11353570105,
	["zombie rush"] = 452074423,
	["bedwars"] = 6872265039,
	["doors"] = 6516141723,
	["evade"] = 9872472334,
	["pet simulator 99"] = 8737899170,
	["rainbow friends"] = 5997569042,
	["royale high"] = 735030788,
	["scp: roleplay"] = 5036208220,
	["slap battles"] = 6403373529,
	["natural disaster survival"] = 189707,
	["meepcity"] = 370731277,
	["weight lifting simulator 5"] = 10808838353,
	["tower of mis fortune"] = 11353525067,
	["starving artists"] = 407274914,
	["item asylum"] = 5397720695,
	["all star tower defense"] = 7813484220,
	["deepwoken"] = 6034313019,
	["michigun"] = 358276974,
	["phantom forces"] = 292439477,
	["saitama battlegrounds"] = 112420803,
	["fencing fever"] = 12109643,
	["squid game"] = 7446760705,
	["plates of fate: remastered"] = 6938803436,
	["voxlblade"] = 662417684,
	["soulshatters"] = 5237310580,
	["legends of speed"] = 4612323819,
	["king legacy"] = 1090792357,
	["demonfall"] = 6288998934,
	["elemental battlegrounds"] = 12153163,
	["bad business"] = 7722706048,
	["project xl"] = 4615814821,
	["combat warriors"] = 7020443575,
	["raging bulls"] = 8395233149,
	["robloxian highscool"] = 100821133,
	["trading legends"] = 3891499192,
	["legendary swords"] = 4803123865,
	["strucid"] = 138251724,
	["dragon adventures"] = 4896611748,
	["bounty hunter"] = 2788229376,
	["space rig"] = 139764537,
	["adventure quest worlds"] = 13602177,
	["redwood prison"] = 5602055509,
	["wild west roblox"] = 392851827,
	["drift paradise"] = 448294661,
	["grand piece online"] = 3101667890,
	["a universal time"] = 2809202155,
	["the wild west"] = 392851827,
	["da hood"] = 2788229376,
	["dti"] = 15101393044,
	["mm2"] = 142823291,
	["psx"] = 6284583030,
	["nds"] = 189707,
	["sb"] = 6711846670,
	["rh"] = 735030788,
	["bb"] = 185655149,
	["jjs"] = 10450270085,
	["ll"] = 4814460316,
	["lt2"] = 204118410,
	["ac2"] = 3182549358,
	["ts"] = 5949022791,
	["tds"] = 3260590327,
	["toh"] = 1962086868,
	["vs"] = 410996670,
	["bw"] = 6872265039,
	["ev"] = 9872472334,
	["scp"] = 5036208220,
	["ttt"] = 150357239,
	["tpt2"] = 402981713,
}

section1:AddToggle({
	Title = "Enable Walkspeed",
	Content = "",
	Callback = function(value)
		config.WalkspeedChanger.Enabled = value
		if humanoid then
			humanoid.WalkSpeed = value and config.WalkspeedChanger.Speed or 16
		end
	end,
})

section1:AddToggle({
	Title = "NoClip",
	Content = "",
	Callback = function(state)
		config.NoClip.Enabled = state
		if state then
			enableNoClip()
		else
			disableNoClip()
		end
	end,
})

section1:AddToggle({
	Title = "Infinite Jump",
	Content = "",
	Callback = function(state)
		config.InfiniteJump.Enabled = state
		if state then
			enableInfiniteJump()
		else
			disableInfiniteJump()
		end
	end,
})

section1:AddToggle({
	Title = "CTRL + Click to Teleport",
	Content = "",
	Callback = function(state)
		task.spawn(function()
			config.Teleport.Enabled = state
			task.spawn(handleTeleport)
		end)
	end,
})

local tabMain = window:CreateTab({ Name = "Tools" })

servertools = tabMain:AddSection("PlaceId Tools", true)

servertools:AddButton({
	Title = "Copy Game PlaceId",
	Content = "Copy Current Game PlaceId",
	Callback = function()
		setclipboard(tostring(game.PlaceId))
		Speed_Library:SetNotification({
			Title = "Success!",
			Content = "PlaceId Copied: " .. game.PlaceId,
			Delay = 1,
		})
	end,
})

servertools:AddInput({
	Title = "Input game",
	Content = 'Example: "fisch" or "16732694052"',
	Default = tostring(game.PlaceId),
	Callback = function(text)
		task.spawn(function()
			local placeid = tonumber(text)
			if placeid then
				config.serverinfo.PlaceId = placeid
				for gamename, place in pairs(games) do
					if tonumber(placeid) == tonumber(place) then
                        config.serverinfo.PlaceId = place,
						Speed_Library:SetNotification({
							Title = tostring(gamename),
							Content = "Successfully selected" .. ": " .. place,
						})
					else
						Speed_Library:SetNotification({
							Title = "Success!",
							Content = "Successfully selected" .. ": " .. place,
						})
					end
				end
			else
				local lowerinput = string.lower(text)
				for name, id in pairs(games) do
					if lowerinput == name then
						config.serverinfo.PlaceId = tonumber(id)
					else
						Speed_Library:SetNotification({
							Title = "Error!",
                            Content = "Invalid game, try game's placeId or full game name like \"build a boat for treasure\"",
						})
					end
				end
			end
		end)
	end
})

servertools:AddLine()

servertools:AddButton({
	Title = "Teleport",
    Content = "Teleport to selected game",
    Callback = function()
        
    end
})
